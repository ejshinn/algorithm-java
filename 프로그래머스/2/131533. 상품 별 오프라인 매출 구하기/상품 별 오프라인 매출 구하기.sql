SELECT PRODUCT_CODE, SUM(P.PRICE * S.SALES_AMOUNT)
FROM PRODUCT P JOIN OFFLINE_SALE S ON P.PRODUCT_ID = S.PRODUCT_ID
GROUP BY PRODUCT_CODE
ORDER BY SUM(P.PRICE * S.SALES_AMOUNT) DESC, PRODUCT_CODE;